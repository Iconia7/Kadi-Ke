  Widget _buildChallengesSection() {
    final challenges = ChallengeService().getActiveChallenges();
    final timeUntilRefresh = ChallengeService().getTimeUntilRefresh();
    
    return Container(
      margin: const EdgeInsets.all(16),
      padding: const EdgeInsets.all(16),
      decoration: BoxDecoration(
        gradient: LinearGradient(
          colors: [Color(0xFF2E1E5F).withOpacity(0.6), Color(0xFF1E1E3A).withOpacity(0.6)],
        ),
        borderRadius: BorderRadius.circular(16),
        border: Border.all(color: Colors.white.withOpacity(0.2)),
      ),
      child: Column(
        crossAxisAlignment: CrossAxisAlignment.start,
        children: [
          Row(
            mainAxisAlignment: MainAxisAlignment.spaceBetween,
            children: [
              Row(
                children: [
                  Icon(Icons.flag, color: Color(0xFF00E5FF), size: 24),
                  SizedBox(width: 8),
                  Text(
                    'DAILY CHALLENGES',
                    style: TextStyle(
                      color: Colors.white,
                      fontSize: 16,
                      fontWeight: FontWeight.bold,
                      letterSpacing: 1,
                    ),
                  ),
                ],
              ),
              Text(
                'Resets in ${timeUntilRefresh.inHours}h ${timeUntilRefresh.inMinutes % 60}m',
                style: TextStyle(color: Colors.white54, fontSize: 11),
              ),
            ],
          ),
          SizedBox(height: 12),
          ...challenges.map((challenge) => DailyChallengeCard(
            challenge: challenge,
            onClaim: () => _claimChallengeReward(challenge.id),
          )).toList(),
        ],
      ),
    );
  }

  Future<void> _claimChallengeReward(String challengeId) async {
    try {
      final rewards = await ChallengeService().claimReward(challengeId);
      if (rewards != null) {
        // Add coins and XP
        ProgressionService().addCoins(rewards['coins']!);
        // TODO: Add XP system (future enhancement)
        
        setState(() {}); // Refresh UI
        
        // Show reward notification
        if (mounted) {
          ScaffoldMessenger.of(context).showSnackBar(
            SnackBar(
              content: Text('Challenge Complete! +${rewards['coins']} coins'),
              backgroundColor: Color(0xFF00E5FF),
              behavior: SnackBarBehavior.floating,
            ),
          );
        }
      }
    } catch (e) {
      print('Error claiming reward: $e');
    }
  }
